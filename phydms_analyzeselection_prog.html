<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>the phydms_analyzeselection program &mdash; phydms 1.2.1 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '1.2.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="top" title="phydms 1.2.1 documentation" href="index.html" />
    <link rel="up" title="auxiliary programs" href="auxiliary_progs.html" />
    <link rel="next" title="the phydms_renumber program" href="phydms_renumber_prog.html" />
    <link rel="prev" title="the phydms_plotselection program" href="phydms_plotselection_prog.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="phydms_renumber_prog.html" title="the phydms_renumber program"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="phydms_plotselection_prog.html" title="the phydms_plotselection program"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phydms 1.2.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="auxiliary_progs.html" accesskey="U">auxiliary programs</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="the-phydms-analyzeselection-program">
<span id="phydms-analyzeselection-prog"></span><h1><a class="toc-backref" href="#id5">the <code class="docutils literal"><span class="pre">phydms_analyzeselection</span></code> program</a><a class="headerlink" href="#the-phydms-analyzeselection-program" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><a class="reference internal" href="#the-phydms-analyzeselection-program" id="id5">the <code class="docutils literal"><span class="pre">phydms_analyzeselection</span></code> program</a><ul>
<li><a class="reference internal" href="#overview" id="id6">Overview</a></li>
<li><a class="reference internal" href="#command-line-usage" id="id7">Command-line usage</a></li>
<li><a class="reference internal" href="#output-plots" id="id8">Output plots</a><ul>
<li><a class="reference internal" href="#omega-violin-plot" id="id9">Omega violin plot</a></li>
<li><a class="reference internal" href="#stringency-violin-plot" id="id10">Stringency violin plot</a></li>
<li><a class="reference internal" href="#differential-preferences-violin-plot" id="id11">Differential preferences violin plot</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="overview">
<h2><a class="toc-backref" href="#id6">Overview</a><a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">phydms_analzyeselection</span></code> is a program that allows you to look at the distribution of site-specific selection values inferred using <code class="docutils literal"><span class="pre">phydms</span></code> with an <em>ExpCM</em>. It creates <a class="reference internal" href="#output-plots">Output plots</a> that show the distribution of selection values, indicates which ones are significant at a given false-discovery rate, and allows specific sites to be highlighted.</p>
<p>You can run <code class="docutils literal"><span class="pre">phydms_analyzeselection</span></code> <strong>after</strong> you have used <code class="docutils literal"><span class="pre">phydms</span></code> (or <code class="docutils literal"><span class="pre">phydms_comprehensive</span></code>) to create files that summarize the site-specific selection.</p>
<p>If you need to change the site numbers from the sequential numbering in the <code class="docutils literal"><span class="pre">phydms</span></code> output, use <a class="reference internal" href="phydms_renumber_prog.html#phydms-renumber-prog"><span class="std std-ref">the phydms_renumber program</span></a> to renumber this output before passing it to <code class="docutils literal"><span class="pre">phydms_analyzeselection</span></code>.</p>
<p>The <a class="reference internal" href="#output-plots">Output plots</a> created by <code class="docutils literal"><span class="pre">phydms_analyzeselection</span></code> are created using <a class="reference external" href="http://matplotlib.org/">matplotlib</a>. You will also need command-line <a class="reference external" href="https://www.latex-project.org/">latex</a> available for rendering of some of the labels, and may get an error message during the plotting if you don&#8217;t have <a class="reference external" href="https://www.latex-project.org/">latex</a>.</p>
<p>See below for information on <a class="reference internal" href="#command-line-usage">Command-line usage</a> for <code class="docutils literal"><span class="pre">phydms_analyzeselection</span></code>.</p>
</div>
<div class="section" id="command-line-usage">
<h2><a class="toc-backref" href="#id7">Command-line usage</a><a class="headerlink" href="#command-line-usage" title="Permalink to this headline">¶</a></h2>
<p>Visualizes distributions of per-site selection inferred with &#8216;phydms&#8217;. Can also highlight information for a subset of sites. The &#8216;phydms&#8217; package is written by the Bloom lab (see <a class="reference external" href="https://github.com/jbloomlab/phydms/contributors">https://github.com/jbloomlab/phydms/contributors</a> for all contributors); it performs likelihood calculations using the Bio++ libraries (thanks to Julien Dutheil and Laurent Gueguen). Version 1.2.1. Full documentation at <a class="reference external" href="http://jbloomlab.github.io/phydms">http://jbloomlab.github.io/phydms</a></p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">usage</span><span class="p">:</span> <span class="n">phydms_analyzeselection</span> <span class="p">[</span><span class="o">-</span><span class="n">h</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">names</span> <span class="n">NAMES</span> <span class="p">[</span><span class="n">NAMES</span> <span class="o">...</span><span class="p">]]</span>
                               <span class="p">[</span><span class="o">--</span><span class="n">selectedsites</span> <span class="n">SELECTEDSITES</span> <span class="p">[</span><span class="n">SELECTEDSITES</span> <span class="o">...</span><span class="p">]]</span>
                               <span class="p">[</span><span class="o">--</span><span class="n">labelselectedsites</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">fdr</span> <span class="n">FDR</span><span class="p">]</span>
                               <span class="p">[</span><span class="o">--</span><span class="n">maxlog10p</span> <span class="n">MAXLOG10P</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">groupbyname</span><span class="p">]</span>
                               <span class="p">[</span><span class="o">--</span><span class="n">diffprefsline</span> <span class="n">DIFFPREFSLINE</span><span class="p">]</span> <span class="p">[</span><span class="o">--</span><span class="n">nolegend</span><span class="p">]</span>
                               <span class="p">[</span><span class="o">--</span><span class="n">dNdSlabel</span><span class="p">]</span>
                               <span class="n">outprefix</span> <span class="n">selectionfiles</span> <span class="p">[</span><span class="n">selectionfiles</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<dl class="docutils">
<dt>Positional arguments:</dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd>outprefix</kbd></td>
<td><p class="first">Prefix for output files.</p>
<p class="last">The program will create one or more output <code class="docutils literal"><span class="pre">PDF</span></code> plots (one plot for each type of selection). The prefix for these files will be <code class="docutils literal"><span class="pre">outprefix</span></code>, and the suffixes will be those described in <a class="reference internal" href="#output-plots">Output plots</a>.</p>
</td></tr>
<tr><td class="option-group">
<kbd>selectionfiles</kbd></td>
<td><p class="first">Per-site selection file(s) created by &#8216;phydms&#8217; (i.e. &#8216;*_omegabysite.txt&#8217;, &#8216;*_stringencybysite.txt&#8217;, &#8216;*_diffprefsbysite.txt&#8217;).</p>
<p>You can specify an arbitrary number of files here.</p>
<p>These files must already exist, and should conform to the format of the <a class="reference internal" href="phydms_prog.html#phydms-prog"><span class="std std-ref">the phydms program</span></a> output files that give the <span class="math">\(\omega_r\)</span>, <span class="math">\(\beta_r\)</span>, or <span class="math">\(\Delta\pi_{r,a}\)</span> values for each site (these are the <code class="docutils literal"><span class="pre">*_omegabysite.txt</span></code>, <code class="docutils literal"><span class="pre">*_stringencybysite.txt</span></code>, or <code class="docutils literal"><span class="pre">*_diffprefsbysite.txt</span></code> files, respectively). You can mix and match multiple types of file &#8211; <code class="docutils literal"><span class="pre">phydms_analyzeselection</span></code> automatically detects which of these three types of selection each file gives, and puts each one in an appropriate one of the <a class="reference internal" href="#output-plots">Output plots</a>.</p>
<p class="last">You can also specify multiple files for each type of selection (these can be the same gene analyzed with multiple models, or different genes), and they will be merged into the same output plot for each type of selection.</p>
</td></tr>
</tbody>
</table>
</dd>
<dt>Options:</dt>
<dd><table class="first last docutils option-list" frame="void" rules="none">
<col class="option" />
<col class="description" />
<tbody valign="top">
<tr><td class="option-group">
<kbd><span class="option">--names</span></kbd></td>
<td><p class="first">Name(s) describing type of selection to go with each &#8216;selectionfile&#8217;.</p>
<p>For the plots, you will typically want to assign a name to the selection in each of the <code class="docutils literal"><span class="pre">selectionfiles</span></code>. By default, the names on the plots are simply the names of the <code class="docutils literal"><span class="pre">selectionfiles</span></code>. However, typically you want clearer and more succinct names, so here you should list the name to go with each one of the <code class="docutils literal"><span class="pre">selectionfiles</span></code>.</p>
<p class="last">The number of listed names must match the number of <code class="docutils literal"><span class="pre">selectionfiles</span></code>, and each name must be unique. For multi-word names, use quotes, as in <code class="docutils literal"><span class="pre">--names</span> <span class="pre">&quot;Gal4</span> <span class="pre">ExpCM&quot;</span> <span class="pre">&quot;Gal4</span> <span class="pre">YNGKP&quot;</span></code>. Note also that you can group multi-word names using the <code class="docutils literal"><span class="pre">--groupbyname</span></code> option.</p>
</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--selectedsites</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td><p class="first">File(s) listing selected sites to display as points. If you give one file, it applies to all &#8216;selectionfiles&#8217;. Otherwise list a different file (or &#8216;None&#8217;) for each file in &#8216;selectionfiles&#8217;. Column 1 is site number, which can be followed by # giving notes. Lines beginning with &#8216;#&#8217; are ignored.</p>
<p>You should use this option if you want to indicate the values for specific points on the violin plots. The value(s) given here should be the names of files that have formats like the following (which specifies that we indicate points for 7 specific sites):</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="c1"># This table lists sites where mutations have been shown to contribute to extended-spectrum</span>
<span class="c1"># resistance in TEM beta-lactamases.</span>
<span class="c1">#</span>
<span class="c1"># Each entry gives the site, and then and &quot;#&quot; followed by associated notes.</span>
<span class="mi">69</span> <span class="c1"># M69I, M69L, and M69V give inhibitor resistance</span>
<span class="mi">130</span> <span class="c1"># S130G gives inhibitor resistance</span>
<span class="mi">164</span> <span class="c1"># R164C, R164H, and R164S give beta-lactam resistance</span>
<span class="mi">237</span> <span class="c1"># A237G and A273T give beta-lactam resistance</span>
<span class="mi">238</span> <span class="c1"># G238S gives beta-lactam resistance</span>
<span class="mi">244</span> <span class="c1"># R244C, R244H, R244S give inhibitor resistance</span>
<span class="mi">276</span> <span class="c1"># R276D gives inhibitor resistance</span>
</pre></div>
</div>
<p>If you just give one file for <code class="docutils literal"><span class="pre">--selectedsites</span></code>, then the sites in this file are labeled for all selections specified by <code class="docutils literal"><span class="pre">selectionfiles</span></code>. Otherwise, you should list one file for each entry in <code class="docutils literal"><span class="pre">selectionfiles</span></code>, and the sites in that file are labeled for each selection. If you don&#8217;t want to label sites for some selections, just put <code class="docutils literal"><span class="pre">None</span></code> for those.</p>
<p class="last">You will get an error if the file lists site numbers for which there isn&#8217;t any information in the associated file in <code class="docutils literal"><span class="pre">selectionfiles</span></code>.</p>
</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--labelselectedsites=False</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td><p class="first">Do we use a unique labeled point on violin plots for each site in &#8216;&#8211;selectedsites&#8217;?</p>
<p class="last">This option is only meaningful if you are using <code class="docutils literal"><span class="pre">--selectedsites</span></code>. In that case, it specifies that rather than simply putting the same point marker at each site specified by <code class="docutils literal"><span class="pre">--selectedsites</span></code>, we use a <strong>different</strong> marker for each point, and then place a legend that indicates the site number to the right of the plot. There is a limit to how many unique site markers are available, so you will get an error if you use this option and specify too many sites in <code class="docutils literal"><span class="pre">--selectedsites</span></code>.</p>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--fdr=0.05</span></kbd></td>
<td><p class="first">False discovery rate for &#8216;omega&#8217; and &#8216;stringency&#8217;. Benjamini-Hochberg FDR computed separately for values &gt; and &lt; 1.</p>
<p>For the plots showing <span class="math">\(\omega_r\)</span> (the <code class="docutils literal"><span class="pre">*_omegabysite.txt</span></code> files) and <span class="math">\(\beta_r\)</span> (the <code class="docutils literal"><span class="pre">*_stringencybysite.txt</span></code> files), a blue dashed line is drawn to indicate the cutoff for sites that have value significantly different from one at this false discovery rate (computed using the <a class="reference external" href="https://en.wikipedia.org/wiki/False_discovery_rate#Benjamini.E2.80.93Hochberg_procedure">Benjamini-Hochberg</a> procedure). Use this option to specify that false discovery rate.</p>
<p>Note that the false discovery rate is computed separately for the hypothesis that the parameter is significantly &gt; 1 and the hypothesis that the parameter is significantly &lt; 1.</p>
<p class="last">Note also that if there are no sites that are significant, the light blue line is drawn at the P-value that a site would need to have in order to be called as significant.</p>
</td></tr>
<tr><td class="option-group">
<kbd><span class="option">--maxlog10p=5</span></kbd></td>
<td><p class="first">For &#8216;omega&#8217; and &#8216;stringency&#8217; violin plots, if log10 P-value has magnitude &gt; this, instead plot as this. Also is y-limits for these plots.</p>
<p class="last">For the plots showing the <span class="math">\(\omega_r\)</span> and the <span class="math">\(\beta_r\)</span> values, we show the <em>log10</em> P-values. Any <em>log10</em> P-values that have magnitude &gt; than this are plotted as this value.</p>
</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--groupbyname=False</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td><p class="first">Group selections with same first word in name specified by &#8216;&#8211;names&#8217;. Grouped selections must have same sites specified by &#8216;&#8211;selectedsites&#8217;.</p>
<p class="last">You may want to group the violin plots and show a single legend for selection values of the same type for the same gene computed with different models. If you use this option, the legend and plots are grouped for any selection files that have names (specified by <code class="docutils literal"><span class="pre">--names</span></code>) that have the same first word. For instance, if you use <code class="docutils literal"><span class="pre">--names</span> <span class="pre">&quot;Gal4</span> <span class="pre">ExpCM&quot;</span> <span class="pre">&quot;Gal4</span> <span class="pre">YNGKP&quot;</span></code> and also specify <code class="docutils literal"><span class="pre">--groupbyname</span></code>, then on the plot these two will be grouped together as part of the <em>Gal4</em> group. If you use this option, selection files in the same group must have the same set of selected sites specified by <code class="docutils literal"><span class="pre">--selectedsites</span></code>.</p>
</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--diffprefsline</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td><p class="first">Draw cutoff line on diffprefs plot: &#8216;lowestpeak&#8217; indicates the lowest peak value for any selection file, otherwise specify a number between 0 and 1.</p>
<p>For the <span class="math">\(\omega_r\)</span> and <span class="math">\(\beta_r\)</span> values, we are able to determine significance using the P-values and the false discovery rate specified by <code class="docutils literal"><span class="pre">--fdr</span></code>. But there is currently no significance testing method to determine if the absolute sum (<span class="math">\(\frac{1}{2}\sum_a \left|\Delta\pi_{r,a}\right|\)</span>) of the differential preferences plotted by this program is significantly larger than we expect.</p>
<p>If you have some other method to establish when you think that the absolute sume of these differential preferences is notably large, you can use this option to draw a dotted blue line at this threshold. There are two ways of doing this:</p>
<blockquote class="last">
<div><ol class="arabic simple">
<li>If you include some sample that you want to make your <em>control</em> sample, you can simply specify <code class="docutils literal"><span class="pre">--diffprefsline</span> <span class="pre">lowestpeak</span></code>, and then the dotted blue line will be drawn at the lowest peak value for any of the samples specified in <code class="docutils literal"><span class="pre">--selectionfiles</span></code>.</li>
<li>If you have a numeric threshold in mind, you can specify that threshold, such as <code class="docutils literal"><span class="pre">--diffprefsline</span> <span class="pre">0.5</span></code>.</li>
</ol>
</div></blockquote>
</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--nolegend=False</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Don&#8217;t place a legend even on plates with labeled selected sites.</td></tr>
<tr><td class="option-group" colspan="2">
<kbd><span class="option">--dNdSlabel=False</span></kbd></td>
</tr>
<tr><td>&nbsp;</td><td>Label omega-by-site plots with &#8216;dN/dS&#8217; rather than &#8216;omega_r&#8217;.</td></tr>
</tbody>
</table>
</dd>
</dl>
</div>
<div class="section" id="output-plots">
<h2><a class="toc-backref" href="#id8">Output plots</a><a class="headerlink" href="#output-plots" title="Permalink to this headline">¶</a></h2>
<p><code class="docutils literal"><span class="pre">phydms_analyzeselection</span></code> will generate a plot for each type of selection represented in the <code class="docutils literal"><span class="pre">selectionfiles</span></code>. These plots will have the prefix <code class="docutils literal"><span class="pre">outprefix</span></code> with the following suffixes:</p>
<blockquote>
<div><ul class="simple">
<li><code class="docutils literal"><span class="pre">*_omega_violinplot.pdf</span></code> for the <span class="math">\(\omega_r\)</span> values (see <a class="reference internal" href="#omega-violin-plot">Omega violin plot</a>).</li>
<li><code class="docutils literal"><span class="pre">*_stringency_violinplot.pdf</span></code> for the <span class="math">\(\beta_r\)</span> values (see <a class="reference internal" href="#stringency-violin-plot">Stringency violin plot</a>).</li>
<li><code class="docutils literal"><span class="pre">*_diffprefs_violinplot.pdf</span></code> for the <span class="math">\(\Delta\pi_{r,a}\)</span> values (see <a class="reference internal" href="#differential-preferences-violin-plot">Differential preferences violin plot</a>).</li>
</ul>
</div></blockquote>
<p>For instance, running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phydms_analyzeselection</span> <span class="n">myplot</span> <span class="n">gene1_omegabysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">gene2_omegabysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">gene1_diffprefsbysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">gene2_diffprefsbysite</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>will create the output files <code class="docutils literal"><span class="pre">myplot_omega_violinplot.pdf</span></code> and <code class="docutils literal"><span class="pre">myplot_diffprefsbysite.txt</span></code>. On the other hand, running:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phydms_analyzeselection</span> <span class="n">myplot</span> <span class="n">gene1_omegabysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">gene2_omegabysite</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
<p>will create just the output file <code class="docutils literal"><span class="pre">myplot_omegaviolinplot.pdf</span></code>.</p>
<p>In addition to these created plots, the script prints some information to standard output about the number of sites that are significant at the FDR rates.</p>
<div class="section" id="omega-violin-plot">
<h3><a class="toc-backref" href="#id9">Omega violin plot</a><a class="headerlink" href="#omega-violin-plot" title="Permalink to this headline">¶</a></h3>
<p>The following command makes a simple plot <code class="docutils literal"><span class="pre">example1_omega_violinplot.pdf</span></code> showing the <span class="math">\(\omega_r\)</span> values:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phydms_analyzeselection</span> <span class="n">example1</span> <span class="n">ExpCM_omegabysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">YNGKP_M3_omegabysite</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">names</span> <span class="n">ExpCM</span> <span class="n">YNGKP</span>
</pre></div>
</div>
<p>In this plot, the y-axis shows the negative <em>log10</em> P-value that <span class="math">\(\omega_r &gt; 1\)</span> for points with <span class="math">\(\omega_r &gt; 1\)</span>, and the <em>log10</em> P-value that <span class="math">\(\omega_r &lt; 1\)</span> for points with <span class="math">\(\omega_r &lt; 1\)</span>. So points at the top of the violin plot are those for which we are more confident of diversifying selection for amino-acid change, and conversely those at the bottom are the ones for which are more confident of selection against amino-acid change. The dotted blue lines indicate the portions of the distribution for which we declare <span class="math">\(\omega_r &gt; 1\)</span> (top line) or <span class="math">\(\omega_r &lt; 1\)</span> (bottom line) at a false discovery rate of 0.05. When there are no significant sites, the dotted blue lines indicate the P-value that would be necessary to declare a single site significant.</p>
<div class="figure align-center" id="id1">
<a class="reference internal image-reference" href="_images/example1_omega_violinplot.pdf"><img alt="If your browser does not display inline PDF images, click on this text to open in a new window." src="_images/example1_omega_violinplot.pdf" style="width: 85%;" /></a>
<p class="caption"><span class="caption-text">The plot <code class="docutils literal"><span class="pre">example1_omega_violinplot.pdf</span></code>.</span></p>
</div>
<p>Here is a more complicated version of a similar plot that now shows to two models (grouped by gene) and labels specific points on one of them:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phydms_analyzeselection</span> <span class="n">example2</span> <span class="n">Gal4</span><span class="o">/</span><span class="n">ExpCM_omegabysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">Gal4</span><span class="o">/</span><span class="n">YNGKP_M3_omegabysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">lactamase</span><span class="o">/</span><span class="n">ExpCM_omegabysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">lactamase</span><span class="o">/</span><span class="n">YNGKP_M3_omegabysite</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">names</span> <span class="s2">&quot;Gal4 ExpCM&quot;</span> <span class="s2">&quot;Gal4 YNGKP&quot;</span> <span class="s2">&quot;lactamase ExpCM&quot;</span> <span class="s2">&quot;lactamase YNGKP&quot;</span> <span class="o">--</span><span class="n">selectedsites</span> <span class="kc">None</span> <span class="kc">None</span> <span class="n">lactamase</span><span class="o">/</span><span class="n">resistance_sites</span><span class="o">.</span><span class="n">txt</span> <span class="n">lactamase</span><span class="o">/</span><span class="n">resistance_sites</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">labelselectedsites</span> <span class="o">--</span><span class="n">groupbyname</span>
</pre></div>
</div>
<p>Here is the created file <code class="docutils literal"><span class="pre">example2_omega_violinplot.pdf</span></code>:</p>
<div class="figure align-center" id="id2">
<a class="reference internal image-reference" href="_images/example2_omega_violinplot.pdf"><img alt="If your browser does not display inline PDF images, click on this text to open in a new window." src="_images/example2_omega_violinplot.pdf" style="width: 85%;" /></a>
<p class="caption"><span class="caption-text">The plot <code class="docutils literal"><span class="pre">example2_omega_violinplot.pdf</span></code>.</span></p>
</div>
</div>
<div class="section" id="stringency-violin-plot">
<h3><a class="toc-backref" href="#id10">Stringency violin plot</a><a class="headerlink" href="#stringency-violin-plot" title="Permalink to this headline">¶</a></h3>
<p>Similar plots to those described in <a class="reference internal" href="#omega-violin-plot">Omega violin plot</a> are created to show the <span class="math">\(\beta_r\)</span> values. Here, values are shown on the top of y-axis if there is evidence for the stringency ratio being less than one (since this indicates different selection than in the deep mutational scanning), and on the bottom if there is evidence for the stringency ratio being greater than one. For instance, the following command produces <code class="docutils literal"><span class="pre">example3_stringency_violinplot.pdf</span></code>:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phydms_analyzeselection</span> <span class="n">example3</span> <span class="n">Gal4_stringencybysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">lactamase_stringencybysite</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">names</span> <span class="n">Gal4</span> <span class="n">lactamase</span>
</pre></div>
</div>
<p>Here is the plot:</p>
<div class="figure align-center" id="id3">
<a class="reference internal image-reference" href="_images/example3_stringency_violinplot.pdf"><img alt="If your browser does not display inline PDF images, click on this text to open in a new window." src="_images/example3_stringency_violinplot.pdf" style="width: 85%;" /></a>
<p class="caption"><span class="caption-text">The plot <code class="docutils literal"><span class="pre">example3_stringency_violinplot.pdf</span></code>.</span></p>
</div>
</div>
<div class="section" id="differential-preferences-violin-plot">
<h3><a class="toc-backref" href="#id11">Differential preferences violin plot</a><a class="headerlink" href="#differential-preferences-violin-plot" title="Permalink to this headline">¶</a></h3>
<p>The plots showing the <span class="math">\(\beta_r\)</span> values is somewhat different. Here the y-axis shows <span class="math">\(\frac{1}{2} \sum_a \left|\Delta\pi_{r,a}\right|\)</span> for each site <span class="math">\(r\)</span>. This number can range from 0 (sites that have differential preferences of zero) to 1 (sites with maximally different differential preferences). There is no significance testing, so in the plot below we take the <em>Gal4</em> sample as our baseline, and use <code class="docutils literal"><span class="pre">lowestpeak</span></code> option to <code class="docutils literal"><span class="pre">--diffprefsline</span></code> to draw a dotted blue line at that cutoff.</p>
<p>Here is the command:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="n">phydms_analyzeselection</span> <span class="n">example4</span> <span class="n">Gal4</span><span class="o">/</span><span class="n">ExpCM_diffprefsbysite</span><span class="o">.</span><span class="n">txt</span> <span class="n">lactamase</span><span class="o">/</span><span class="n">ExpCM_diffprefsbysite</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">names</span> <span class="n">Gal4</span> <span class="n">lactamase</span> <span class="o">--</span><span class="n">selectedsites</span> <span class="kc">None</span> <span class="n">lactamase</span><span class="o">/</span><span class="n">resistance_sites</span><span class="o">.</span><span class="n">txt</span> <span class="o">--</span><span class="n">labelselectedsites</span> <span class="o">--</span><span class="n">diffprefsline</span> <span class="n">lowestpeak</span>
</pre></div>
</div>
<p>Here is the created plot <code class="docutils literal"><span class="pre">example4_diffprefs_violinplot.pdf</span></code>:</p>
<div class="figure align-center" id="id4">
<a class="reference internal image-reference" href="_images/example4_diffprefs_violinplot.pdf"><img alt="If your browser does not display inline PDF images, click on this text to open in a new window." src="_images/example4_diffprefs_violinplot.pdf" style="width: 85%;" /></a>
<p class="caption"><span class="caption-text">The plot <code class="docutils literal"><span class="pre">example4_diffprefs_violinplot.pdf</span></code>.</span></p>
</div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">the <code class="docutils literal"><span class="pre">phydms_analyzeselection</span></code> program</a><ul>
<li><a class="reference internal" href="#overview">Overview</a></li>
<li><a class="reference internal" href="#command-line-usage">Command-line usage</a></li>
<li><a class="reference internal" href="#output-plots">Output plots</a><ul>
<li><a class="reference internal" href="#omega-violin-plot">Omega violin plot</a></li>
<li><a class="reference internal" href="#stringency-violin-plot">Stringency violin plot</a></li>
<li><a class="reference internal" href="#differential-preferences-violin-plot">Differential preferences violin plot</a></li>
</ul>
</li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="phydms_plotselection_prog.html"
                        title="previous chapter">the <code class="docutils literal"><span class="pre">phydms_plotselection</span></code> program</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="phydms_renumber_prog.html"
                        title="next chapter">the <code class="docutils literal"><span class="pre">phydms_renumber</span></code> program</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/phydms_analyzeselection_prog.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="phydms_renumber_prog.html" title="the phydms_renumber program"
             >next</a> |</li>
        <li class="right" >
          <a href="phydms_plotselection_prog.html" title="the phydms_plotselection program"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">phydms 1.2.1 documentation</a> &raquo;</li>
          <li class="nav-item nav-item-1"><a href="auxiliary_progs.html" >auxiliary programs</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &copy; Copyright 2015, Jesse D. Bloom.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.4.
    </div>
  </body>
</html>